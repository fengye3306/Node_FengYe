


## 三维空间坐标系性质

其实，就是一句话就能全部概括刚体运动：**左乘一个矩阵表示线性变化。**

> 描述不同坐标系中相同点的位置 

*空间本混沌一片，有坐标系才有坐标* 

![坐标系之间的关系](./img/00_kinematics/0.png ':size=300')

对于空间中定点@P@，其在坐标系A下的表达为@A_P@，在坐标系B下的表达为@B_P@ ,是否存在一个关系 @\xi^AB@（@\xi@：/ksaɪ/ ）使得有如下代数表达：  

@@
A_P =  \xi^AB \cdot B_P
@@

在这里，我们猜测，坐标系之间存在某种神奇的**关系**，这种关系使得可以将空间对于@B@坐标系下的表达转换到@A@坐标系下的表达。


> 坐标系间相对关系性质

1. **可叠加性**

![可叠加性](./img/00_kinematics/1.png ':size=300')

坐标系@A@与坐标系@B@存在一个关系，坐标系@C@与坐标系@B@也存在一个关系，则应该存在如下代数表达式：  

@@
\xi^AC =  \xi^AB \circ \xi^BC
@@

这里描述额是空间关系的叠加性质@\circ@符号表达的是**叠加**。   


@@
A_P =  \xi^AC \cdot C_P =  \left( \xi^AB \circ \xi^BC \right) \cdot C_P
@@


2. **可倒逆性**

如果坐标系B对于坐标系A存在关系@\xi^BA@ ，那么坐标系A对于坐标系B也应该存在关系@\xi^AB@，因为坐标系之间的关系是相对的。   
这里的代数式表达应该满足：  
@@
\xi^AB \circ \xi^BA = 1  
@@

两个相对关系叠加应该相当于，不作用。表达为@1@，这里的数字@1@暂时表达的是一个抽象概念————**不变**。      



## 运动学（Kinematics）

*运动学（Kinematics）：讨论运动状态本身*    
即讨论**位置（x）**、**速度（y）**、**加速度（a）**、**时间（t）**四个参数之间的关系

> 速度的定义：   

速度是位置关于时间的微分，表示的是单位时间内位置的变化率。   

@@
v = \frac{d}{dt} x
@@

> 加速度的定义：   

加速度是速度关于时间的微分，表示单位时间内速度的变化率，说白了速度再微分一次，就变成了加速度，表达的是速度的变化率。      
@@
a = \frac{d}{dt} v
@@

> 加速度与位置的关系：   

加速度是位置关于时间的两次微分，也就是上面两式的推导式。 

@@
a = \frac{d^2}{dt^2} x
@@

> 能量守恒关系：  

实际上是上面三式的推导式，消去时间的@dt@后得到， 速度的变化与加速度和位移的关系是相互联系的，反映了动能和功的关系。   
@@
v \, dv = a \, dx
@@

推导：  
@@
a = \frac{dv}{dt} = \frac{dv}{dx} \cdot \frac{dx}{dt} = v \frac{dv}{dx}
@@

## 动力学（Dynamics）   

*动力学（Dynamics）回顾： 讨论力/力矩如何产生运动*   

> 牛顿第二定律（Newton‘s 2nd Law）：

物理学中力、质量和加速度之间的关系。    

@@
\Sigma F = ma
@@

@\Sigma F@表示作用上所有外力总和，@m@是物体的质量，@a@是物体的加速度。

> 功与能量 （Work & Energy）  

@@
t_1 + V_1 + U_1 - 2’ = t_2 + V_2
@@

这个方程式表达的是在不同时间下的能量守恒关系，即初始能量（动能 + 势能 + 非保守力的功 - 修正项）与最终能量（动能 + 势能）之间的关系。   

* 动能（Kinetic Energy）：    
@t@当物体在动时，它有动能。比如，一个快速跑的小球有动能。   

* 势能（静止的能量）：    
@V@指当物体在某个高度时，比如在山上，它有势能。比如，一个在高处的球有可能掉下来，所以它有势能。  

* 非保守力的功：   
@U_1 - 2’@这是指一些力（如摩擦力）会把能量变成热量或其他形式，导致能量损失。    


> 冲量与动量（Impulse & Momentum）  

* **动量（Momentum）**是物体的质量与其速度的乘积：   

@@
p = m \cdot v
@@
 
@p@ 是动量，@m@ 是物体的质量，@v@ 是物体的速度。   


* **冲量（Impulse）**冲量是施加在物体上的力与作用时间的乘积：    

@@
J = F \Delta t
@@

@F@是施加的力，@\Delta t@是力作用的时间    


想象一下一个小球。动量就像是小球的“运动力量”。它的大小和两个因素有关：    
质量（@m@）：小球有多重，比如说是2千克。    
速度（@v@）：小球移动得有多快，比如说它的速度是3米每秒。    
这就是说，动量等于小球的质量（2千克）乘以它的速度（3米每秒），所以小球的动量是6千克·米/秒。       
**动量 是小球在运动时的力量，跟小球的质量和速度有关。**  

冲量可以想象成你推小球的力量。比如你用力推这个小球：   
力量（@F@）：你推小球的力度，比如说你用10牛顿的力。  
时间（@\Delta t@）：你推小球的时间，比如说你推了2秒。   
这意味着冲量等于你施加的力量（10牛顿）乘以时间（2秒），所以冲量是20牛顿·秒。    
**冲量 是你施加在小球上的力量，跟你施力的大小和时间有关。**    

 
* **冲量-动量定理**   

@@
\int \Sigma F \, dt = \Delta p = p_2 - p_1
@@  

@ \int \Sigma F @表示合力对时间的积分。  
这个公式告诉我们，当一个力作用在物体上并持续一段时间时，这个力所产生的冲量等于物体动量的变化量。换句话说：      
如果你施加一个力，物体的动量就会发生变化。  
力作用的时间越长，或者力越大，物体动量的变化就越大。   




## 正运动学   

![正运动学](./img/00_kinematics/2.png ':size=300')

**机器人正运动学可以用一句话描述：**  如果我知道各个关节@\theta_1@、 @\theta_2@ 、@\theta_3@、@\theta_4@......@\theta_n@的角度，那么我可以推导出机器人末端位置@P@在世界坐标系下的具体位置。此时@\theta@为自变量，@P@为因变量。        

因此，若要进行正运动学求解，我们需要具备哪些信息呢？首先，毫无疑问是各个关节的角度@\theta@，这是解算的基础。  
其次，必须了解每个杆件之间的相对几何关系。一旦掌握了这些几何信息，就能够为每个杆件建立对应的坐标系（frame），进而完成末端位置的推导。  

> 手臂的几何描述——轴间距离（Link Length）

![轴长](./img/00_kinematics/3.png ':size=300')   

如图，在两条相邻的**关节轴线**之间，如果它们是平行的或不共面，我们需要找到这**两条轴线之间的最短距离**。这条最短距离是沿着第 @i@ 个坐标系的@x_i@轴测量的，这就是轴间距离@a_i@。**换句话说，轴间距离是两条相邻关节轴线的公共垂线的长度。**     

实际上，多轴机械臂是由n个轴与杆串联起来的。如果对于每一轴杆相连，我们只需要两个参数就可以了，两个参数一个定义**杆长**一个定义**角度**,诶，这不就是极坐标吗！   

### DH表示法&关节坐标系推导

*Denavit-Hartenberg（DH）表示法是一种系统化的方法，用于描述和分析机械臂及其他多关节机器人系统的几何结构和运动学特性。由法国工程师Jacques Denavit和理查德 Hartenberg在1955年提出。*   

直白的说，DH表示法本质就是极坐标在三维空间中的应用，即用四个值描述了空间中的刚体运动。  
关节与关节互相连杆链接，两轴之间，其坐标转换关系通过DH参数死死绑定。  

![一般杆件的关节坐标系](./img/00_kinematics/6.png ':size=300')     

* **连杆长度** @a_{i-1}@：表示两个关节之间的距离，是沿着前一个连杆的 x 轴的平移量。   
    以@x_{i-1}@方向看@z_{i-1}@和@z_i@之间的距离   

* **连杆扭角** @a_{i-1}@：表示两个关节之间的相对扭转角度，是沿着 x 轴的旋转角度。   
    以@x_{i-1}@方向看，@z_{i-1}@和@z_i@之间的夹角（@ai>0@）   

* **关节偏移** @d_i@：表示关节沿着 z 轴的位移量。   
    沿着@z_i@方向看，@x_{i-1}@和@x_i@之间的距离。   

* **关节角度** @\theta_i@：表示关节绕着 z 轴的旋转角度。   
    沿着@z_i@方向看，@x_{i-1}@和@x_i@之间的夹角。     


**而想要使用这套DH表示法的前提也正是需要建立机械臂的各个关节的关节极坐标，这个极坐标需要用固定的方式推导，如下一一介绍之。**   


> 非特殊杆件关节坐标系的建立

在此处讨论的非特殊杆件，是指除去地杆（link0）和末端杆之外的中间连杆。     

![一般杆件的关节坐标系](./img/00_kinematics/4.png ':size=300')    

1. **确定关节坐标系的 Z 轴**  
关节坐标系的 Z 轴通过关节的运动特性确定，机器人关节主要分为两类，每类都有其固定的轴线定义：   

`旋转关节（Revolute Joint）`：       
定义：允许机器人部件围绕固定轴旋转的关节。   
轴线：旋转关节的轴线是其旋转运动的中心线（如图所示），通常与局部坐标系的 Z 轴重合，方向可以自行选择。     
`移动关节（Prismatic Joint）`：       
定义：允许机器人部件沿固定方向线性移动的关节。    
轴线：移动关节的轴线为其线性运动的方向，通常与局部坐标系的 Z 轴重合，方向可以自行选择。  

2. **确定关节坐标系的 X 轴**    
在确定 Z 轴之后，可以依据相邻关节的 Z 轴来定义 X 轴。X 轴被定义为两相邻关节的 Z 轴之间的垂直线。如图所示，关节 i-1 的 X 轴沿着参数@a_{i-1}@的方向。由此，Z 轴和 X 轴的交点形成关节坐标系的原点。   

如果两个关节的z轴平行，那么它们之间就有无数条公垂线。  
这时可挑选与下一关节的公垂线共线的一条公垂线， 这样做可以简化模型（关节距d为0）。  

![两轴相交](./img/00_kinematics/5.png ':size=300')       
当两 Z 轴相交时，即@a_{i-1}@为 0 的情况下，这时可将**垂直于两条轴线构成的平面的直线**指定为x轴。  



3. **确定关节坐标系的 Y 轴**     

Y 轴的方向通过右手定则确定，即右手大拇指指向 X 轴，食指指向 Z 轴，此时中指的方向即为 Y 轴方向。如图所示。

> 特殊杆件的处理   

对于地杆（link 0）和末端杆（end-effector），坐标系的建立方式略有不同，需分别处理。  

1.  地杆（link 0）  

地杆是机械臂的固定基座，其坐标系在关节变@\theta_1=0°@时与第一个关节（link 1）的坐标系重合。  
即直接取关节一处于@\theta_1=0°@状态时的关节一坐标系。

2. 末端杆（end-effector）

末端杆（n）无法确定X轴，其X轴取（n-1）轴同向延伸。   


## DH参数转换仿射变换矩阵

![DH转换仿射变换矩阵](./img/00_kinematics/7.png ':size=300')       

## Forward Kinematics  

*正运动学Forward Kinematics* 
![正运动学](./img/00_kinematics/8.png ':size=300')   

正运动学是指通过每个关节角度@\theta_{\text{jont}}@计算末端执行器@p@的位置。   

在此过程中，还涉及一个关键问题，即驱动控制单元如何控制关节的运动。  
以马达为例，假设马达转动角度为@\theta_{\text{motor}} = 1^\circ@ 则关节的转动角度为@\theta_{\text{jont}} = 1^\circ@。    
这表明控制单元的转动与杆件的转动之间存在转换关系，这正是**齿轮比（减速比）**的概念由来。       
该过程的减速比可表示为：  

@@
\text{Gear Ratio} = \frac{\theta_{\text{motor}}}{\theta_{\text{joint}}}
@@  






